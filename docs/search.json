[
  {
    "objectID": "docs/index.html",
    "href": "docs/index.html",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "",
    "text": "I’m a social epidemiologist and public health researcher specializing in data science for causal inference. I authored the thesis Child Development Among Ecuadorian Children Aged Three to Five Born from Intended and Unintended Pregnancies: A Health Equity Analysis and contributed to a range of research projects in the fields of population health and open science public policy.\nI completed my Master of Science in Population and Public Health at the University of British Columbia. I also hold a Master of Public Policy and Global Affairs from UBC, complemented by my Medical Doctor degree from Universidad Tecnológica Equinoccial in Quito, Ecuador. My professional development spans biostatistics, data science, and research methodologies, with certifications from institutions such as Johns Hopkins University, Stanford University, and Vanderbilt University.\nI currently work as a Data Analyst at Simon Fraser University, where I lead data management and analysis initiatives for multiple research projects focusing on health equity and public health outcomes, particularly among marginalized communities. My role involves extensive collaboration with interdisciplinary teams, ensuring the integrity and accuracy of data processes, and contributing to high-impact publications and policy recommendations.\nAs part of my service to the profession, I’ve been a reviewer for top (Q1) journals such as the American Journal of Public Health, European Heart Journal, BMC Public Health, JMIR, and others. I worked as a technical translator in the past, and had volunteered since as a screener for systematic reviews or collaborating in forward or backward translation for validated instruments, like the 7C vaccination readiness questionnaire.\nI have consulted for UrbanDesign4Health (2022-2023), Freedom House (2015-2017), Internews (2016), and ChildFund (2020)."
  },
  {
    "objectID": "docs/index.html#bio",
    "href": "docs/index.html#bio",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "",
    "text": "I’m a social epidemiologist and public health researcher specializing in data science for causal inference. I authored the thesis Child Development Among Ecuadorian Children Aged Three to Five Born from Intended and Unintended Pregnancies: A Health Equity Analysis and contributed to a range of research projects in the fields of population health and open science public policy.\nI completed my Master of Science in Population and Public Health at the University of British Columbia. I also hold a Master of Public Policy and Global Affairs from UBC, complemented by my Medical Doctor degree from Universidad Tecnológica Equinoccial in Quito, Ecuador. My professional development spans biostatistics, data science, and research methodologies, with certifications from institutions such as Johns Hopkins University, Stanford University, and Vanderbilt University.\nI currently work as a Data Analyst at Simon Fraser University, where I lead data management and analysis initiatives for multiple research projects focusing on health equity and public health outcomes, particularly among marginalized communities. My role involves extensive collaboration with interdisciplinary teams, ensuring the integrity and accuracy of data processes, and contributing to high-impact publications and policy recommendations.\nAs part of my service to the profession, I’ve been a reviewer for top (Q1) journals such as the American Journal of Public Health, European Heart Journal, BMC Public Health, JMIR, and others. I worked as a technical translator in the past, and had volunteered since as a screener for systematic reviews or collaborating in forward or backward translation for validated instruments, like the 7C vaccination readiness questionnaire.\nI have consulted for UrbanDesign4Health (2022-2023), Freedom House (2015-2017), Internews (2016), and ChildFund (2020)."
  },
  {
    "objectID": "docs/index.html#key-research-interests",
    "href": "docs/index.html#key-research-interests",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "Key research interests",
    "text": "Key research interests\n\nSocial Epidemiology: trend analysis, health disparities, social determinants of health, intersectionality, mental health in marginalized populations.\nCausal Inference: application of advanced statistical methods, identifying causal relationships in public health, mediation analysis, directed acyclic graphs (DAGs)\nPublic Health Data Science: big data in public health, data management and visualization, machine learning applications in epidemiology, reproducible research practices\nOpen Science: open-access publishing, transparency in research, collaborative research platforms, data sharing and ethics"
  },
  {
    "objectID": "docs/index.html#teaching",
    "href": "docs/index.html#teaching",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "Teaching",
    "text": "Teaching\nDuring my graduate studies, I served as a Teaching Assistant for SPPH581Y (Winter 2020), where I supported Drs. Peter Berman and Milind Kandlikar in guiding students through the complexities of how institutional, organizational, governance, and political factors influenced national responses to the COVID-19 pandemic.\nAt the undergraduate level, I was involved in curriculum development for SPPH 481D: Global Health Policy and Systems in Spring 2022, under the supervision of Dr. Veena Sriram and Dr. Peter Berman. Additionally, I served as an Instructor at the Faculty of Health Sciences at Universidad UTE in Ecuador, where I taught Problem-Based Learning from 2017 to 2018, engaging approximately 150 students."
  },
  {
    "objectID": "docs/index.html#selected-papers",
    "href": "docs/index.html#selected-papers",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "Selected papers",
    "text": "Selected papers\nSalway, T., Delgado-Ron J.A., Rich A.J., Dharma, C., Baams L., & Fish, J. (2024). Trends in mental health and smoking disparities between sexual minority and heterosexual adults in Canada, 2003-2020. SSM - Population Health 27, 101976. https://doi.org/10.1016/j.ssmph.2024.101697.\nDelgado-Ron, J. A., Jeyabalan, T., Watt, S., & Salway, T. (2024). Mitigating invalid data bias in the estimation of sexual orientation disparities in a survey of youth in US and Canada. Child Development. https://doi.org/10.1111/cdev.14111 [In press].\nDelgado-Ron, J. A., López-Jaramillo, P., & Karim, M. E. (2022). Sodium intake and high blood pressure among adults on caloric deficit: a multi-year cross-sectional analysis of the US population, 2007–2018. Journal of Human Hypertension 36, 968–975. https://doi.org/10.1038/s41371-021-00614-4 Professional affiliations\nDelgado-Ron, J. A., Adhikari, B., Van den Bosch, M., Dummer, T., Hong, A., Sandhu, J., … & Frank, L. D. (2021). Community design and hypertension: Walkability and park access relationships with cardiovascular health. International Journal of Hygiene and Environmental Health, 237, 113820. https://doi.org/10.1016/j.ijheh.2021.113820"
  },
  {
    "objectID": "docs/index.html#personal-life",
    "href": "docs/index.html#personal-life",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "Personal life",
    "text": "Personal life\nI live in Ottawa, ON, with my wife, Andrea, and my daughter, Alice. I was born in Quito, Ecuador, but spent my formative years in Vancouver, BC. I have been a permanent resident of Canada since 2029.\nIn my free time, I enjoy reading (mostly non-fiction graphic novels), biking, and playing chess (I have a 1600 chess.com rating). I write as a hobby and have won third place in a national contest of really short stories (my micro tales have been included in a couple of anthologies). I was first published in English in “Writing in the Time of COVID.”"
  },
  {
    "objectID": "docs/index.html#r-code-stories",
    "href": "docs/index.html#r-code-stories",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "R Code Stories",
    "text": "R Code Stories\n\nCreating BC Schools Master File is a short data-wrangling story about matching schools with health authorities using publicly available datasets."
  },
  {
    "objectID": "docs/Creating_BC_schools_Master_File.html",
    "href": "docs/Creating_BC_schools_Master_File.html",
    "title": "Creating the BC Schools Master File",
    "section": "",
    "text": "This document uses two data sources:\n\nThe mailing information for all schools from the BC School District and Contact Information website (https://bcschoolcontacts.gov.bc.ca/). Click “Download Schools Info” followed up by “All schools”; and\nBC Stats’ Translation of Place Names into Administrative Areas. You can search this file with quotation marks at the BC Stats website (https://www2.gov.bc.ca/gov/search), but you will have better luck with the direct link (below)."
  },
  {
    "objectID": "docs/Creating_BC_schools_Master_File.html#data-sources",
    "href": "docs/Creating_BC_schools_Master_File.html#data-sources",
    "title": "Creating the BC Schools Master File",
    "section": "",
    "text": "This document uses two data sources:\n\nThe mailing information for all schools from the BC School District and Contact Information website (https://bcschoolcontacts.gov.bc.ca/). Click “Download Schools Info” followed up by “All schools”; and\nBC Stats’ Translation of Place Names into Administrative Areas. You can search this file with quotation marks at the BC Stats website (https://www2.gov.bc.ca/gov/search), but you will have better luck with the direct link (below)."
  },
  {
    "objectID": "docs/Creating_BC_schools_Master_File.html#importing-data",
    "href": "docs/Creating_BC_schools_Master_File.html#importing-data",
    "title": "Creating the BC Schools Master File",
    "section": "Importing Data",
    "text": "Importing Data\nLoading the files:\n\nmailing &lt;- read.csv(\"allschoolcontacts.csv\", na.strings = \"\") %&gt;%\n  janitor::clean_names() %&gt;% \n  select(district_number, \n         school_code, \n         school_name, \n         postal_code,\n         physical_postal_code,\n         school_category, \n         type,\n         city) %&gt;% \n  rename(school_district = district_number)\n# You may select other variables in the future \n# (e.g., enrollment for some grades)\n\nadmin_areas &lt;- openxlsx::read.xlsx(\"https://www2.gov.bc.ca/assets/gov/data/geographic/land-use/administrative-boundaries/translation_place_names2019.xlsx\", startRow = 4)%&gt;% \n  janitor::clean_names() %&gt;% \n  slice(.,-1) %&gt;% #The first row is empty data\n  rename(health_authority_name = x11)"
  },
  {
    "objectID": "docs/Creating_BC_schools_Master_File.html#data-wrangling",
    "href": "docs/Creating_BC_schools_Master_File.html#data-wrangling",
    "title": "Creating the BC Schools Master File",
    "section": "Data wrangling",
    "text": "Data wrangling\nLet’s take a look at the mailing dataset:\n\nglimpse(mailing)\n\nRows: 2,304\nColumns: 8\n$ school_district      &lt;int&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5…\n$ school_code          &lt;int&gt; 501007, 501009, 501010, 501017, 502001, 502011, 5…\n$ school_name          &lt;chr&gt; \"Jaffray Elem-Jr Secondary\", \"Isabella Dicken Ele…\n$ postal_code          &lt;chr&gt; \"V0B1T0\", \"V0B1M0\", \"V0B2G0\", \"V0B1H0\", \"V1C1B2\",…\n$ physical_postal_code &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ school_category      &lt;chr&gt; \"Public School\", \"Public School\", \"Public School\"…\n$ type                 &lt;chr&gt; \"Standard school\", \"Standard school\", \"Standard s…\n$ city                 &lt;chr&gt; \"JAFFRAY\", \"FERNIE\", \"SPARWOOD\", \"ELKFORD\", \"CRAN…\n\n\nIt looks like the schools have two postal codes. We need the physical postal code because we are interested in the distance from the school to the student’s house. But most schools only provided this information under “postal code”. So we need to do some cleaning here:\n\n# If the physical_postal_code variable is not empty, \n# I want it to replace the postal_code variable\n\nmailing$postal_code &lt;- ifelse(!is.na(mailing$physical_postal_code), #condition\n                              mailing$physical_postal_code, #true \n                              mailing$postal_code) #false\n\n# Now we can delete redundant information\nmailing$physical_postal_code &lt;- NULL\n\nWe also need the short version of the postal code for later.\n\n# substr (target, first_character, last_character)\nmailing$short_postal_code &lt;- substr(mailing$postal_code,1,3)\n\nNow that everything is sorted, we can just add the health authorities from the admin_areas file.\n\n# I am telling R to match the two dataframes by school_district,\n# then to find the health_authority_name  variable in the admin_areas dataframe.\nmailing$health_authority &lt;-\n  admin_areas$health_authority_name[match(mailing$school_district,\n                                          admin_areas$school_district)]\n\n# That is all I needed from this dataframe\nadmin_areas &lt;- NULL\n\nDid everyone get a health authority?\n\nround(100*prop.table(table(!is.na(mailing$health_authority))),1)\n\n\nFALSE  TRUE \n  2.4  97.6 \n\n\nIt looks like a few entries did not. Let’s find out which districts are missing.\n\nunique(mailing$school_district[is.na(mailing$health_authority)])\n\n[1] 93\n\n\nOk, I just googled it!\n\nThe Conseil scolaire francophone de la Colombie-Britannique is the French-language school board for all French schools located in British Columbia.\n\nThis is an interesting problem because district 93 is the only one that can be located in many health authorities. So, we are going to find the health authority for each school using their 3-character postal code. But first, I want to make sure all missing postal codes can be matched with existing postal codes.\n\nlost_postal_codes &lt;- mailing$short_postal_code[is.na(mailing$health_authority)]\nknown_postal_codes &lt;- mailing$short_postal_code[!is.na(mailing$health_authority)]\n\ntable(lost_postal_codes %in% known_postal_codes) #Verifying no one is left behind\n\n\nTRUE \n  55 \n\n\nSuccess! Now let’s get to work. First I want to create a dataframe with short postal codes and health authorities\n\nHA_finder &lt;- mailing  %&gt;% \n  filter(!is.na(health_authority)) %&gt;% \n  group_by(short_postal_code) %&gt;% \n  reframe(HA = health_authority) %&gt;%\n  unique.array() \n\nglimpse(HA_finder)\n\nRows: 207\nColumns: 2\n$ short_postal_code &lt;chr&gt; \"V0A\", \"V0B\", \"V0C\", \"V0E\", \"V0E\", \"V0G\", \"V0H\", \"V0…\n$ HA                &lt;chr&gt; \"Interior\", \"Interior\", \"Northern\", \"Interior\", \"Nor…\n\n\nNext, I want to separate the French schools from the rest. Technically speaking, this is not really required. But it is easier to understand the code this way.\n\nmailing_complete &lt;- mailing %&gt;% filter(!is.na(health_authority))\nmailing_missing  &lt;- mailing %&gt;% filter(is.na(health_authority))\n\nNow we can match the health authority by postal code, just like we did before with school districts.\n\nmailing_missing$health_authority &lt;-\n  HA_finder$HA[match(mailing_missing$short_postal_code,\n                     HA_finder$short_postal_code)]\n\nFinally, we put together the pieces of the broken data frame and save it as a csv file to import it into the caraspace.\n\nmaster_file &lt;- rbind(mailing_complete,mailing_missing)\nwrite.csv(x = master_file, file = \"BC_schools_master_file.csv\")"
  },
  {
    "objectID": "docs/Creating_BC_schools_Master_File.html#downloads",
    "href": "docs/Creating_BC_schools_Master_File.html#downloads",
    "title": "Creating the BC Schools Master File",
    "section": "Downloads",
    "text": "Downloads\nDownload the file here."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "",
    "text": "I’m a social epidemiologist and public health researcher specializing in data science for causal inference. I authored the thesis Child Development Among Ecuadorian Children Aged Three to Five Born from Intended and Unintended Pregnancies: A Health Equity Analysis and contributed to a range of research projects in the fields of population health and open science public policy.\nI completed my Master of Science in Population and Public Health at the University of British Columbia. I also hold a Master of Public Policy and Global Affairs from UBC, complemented by my Medical Doctor degree from Universidad Tecnológica Equinoccial in Quito, Ecuador. My professional development spans biostatistics, data science, and research methodologies, with certifications from institutions such as Johns Hopkins University, Stanford University, and Vanderbilt University.\nI currently work as a Data Analyst at Simon Fraser University, where I lead data management and analysis initiatives for multiple research projects focusing on health equity and public health outcomes, particularly among marginalized communities. My role involves extensive collaboration with interdisciplinary teams, ensuring the integrity and accuracy of data processes, and contributing to high-impact publications and policy recommendations.\nAs part of my service to the profession, I’ve been a reviewer for top (Q1) journals such as the American Journal of Public Health, European Heart Journal, BMC Public Health, JMIR, and others. I worked as a technical translator in the past, and had volunteered since as a screener for systematic reviews or collaborating in forward or backward translation for validated instruments, like the 7C vaccination readiness questionnaire.\nI have consulted for UrbanDesign4Health (2022-2023), Freedom House (2015-2017), Internews (2016), and ChildFund (2020)."
  },
  {
    "objectID": "index.html#bio",
    "href": "index.html#bio",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "",
    "text": "I’m a social epidemiologist and public health researcher specializing in data science for causal inference. I authored the thesis Child Development Among Ecuadorian Children Aged Three to Five Born from Intended and Unintended Pregnancies: A Health Equity Analysis and contributed to a range of research projects in the fields of population health and open science public policy.\nI completed my Master of Science in Population and Public Health at the University of British Columbia. I also hold a Master of Public Policy and Global Affairs from UBC, complemented by my Medical Doctor degree from Universidad Tecnológica Equinoccial in Quito, Ecuador. My professional development spans biostatistics, data science, and research methodologies, with certifications from institutions such as Johns Hopkins University, Stanford University, and Vanderbilt University.\nI currently work as a Data Analyst at Simon Fraser University, where I lead data management and analysis initiatives for multiple research projects focusing on health equity and public health outcomes, particularly among marginalized communities. My role involves extensive collaboration with interdisciplinary teams, ensuring the integrity and accuracy of data processes, and contributing to high-impact publications and policy recommendations.\nAs part of my service to the profession, I’ve been a reviewer for top (Q1) journals such as the American Journal of Public Health, European Heart Journal, BMC Public Health, JMIR, and others. I worked as a technical translator in the past, and had volunteered since as a screener for systematic reviews or collaborating in forward or backward translation for validated instruments, like the 7C vaccination readiness questionnaire.\nI have consulted for UrbanDesign4Health (2022-2023), Freedom House (2015-2017), Internews (2016), and ChildFund (2020)."
  },
  {
    "objectID": "index.html#key-research-interests",
    "href": "index.html#key-research-interests",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "Key research interests",
    "text": "Key research interests\n\nSocial Epidemiology: trend analysis, health disparities, social determinants of health, intersectionality, mental health in marginalized populations.\nCausal Inference: application of advanced statistical methods, identifying causal relationships in public health, mediation analysis, directed acyclic graphs (DAGs)\nPublic Health Data Science: big data in public health, data management and visualization, machine learning applications in epidemiology, reproducible research practices\nOpen Science: open-access publishing, transparency in research, collaborative research platforms, data sharing and ethics"
  },
  {
    "objectID": "index.html#teaching",
    "href": "index.html#teaching",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "Teaching",
    "text": "Teaching\nDuring my graduate studies, I served as a Teaching Assistant for SPPH581Y (Winter 2020), where I supported Drs. Peter Berman and Milind Kandlikar in guiding students through the complexities of how institutional, organizational, governance, and political factors influenced national responses to the COVID-19 pandemic.\nAt the undergraduate level, I was involved in curriculum development for SPPH 481D: Global Health Policy and Systems in Spring 2022, under the supervision of Dr. Veena Sriram and Dr. Peter Berman. Additionally, I served as an Instructor at the Faculty of Health Sciences at Universidad UTE in Ecuador, where I taught Problem-Based Learning from 2017 to 2018, engaging approximately 150 students."
  },
  {
    "objectID": "index.html#selected-papers",
    "href": "index.html#selected-papers",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "Selected papers",
    "text": "Selected papers\nSalway, T., Delgado-Ron J.A., Rich A.J., Dharma, C., Baams L., & Fish, J. (2024). Trends in mental health and smoking disparities between sexual minority and heterosexual adults in Canada, 2003-2020. SSM - Population Health 27, 101976. https://doi.org/10.1016/j.ssmph.2024.101697.\nDelgado-Ron, J. A., Jeyabalan, T., Watt, S., & Salway, T. (2024). Mitigating invalid data bias in the estimation of sexual orientation disparities in a survey of youth in US and Canada. Child Development. https://doi.org/10.1111/cdev.14111 [In press].\nDelgado-Ron, J. A., López-Jaramillo, P., & Karim, M. E. (2022). Sodium intake and high blood pressure among adults on caloric deficit: a multi-year cross-sectional analysis of the US population, 2007–2018. Journal of Human Hypertension 36, 968–975. https://doi.org/10.1038/s41371-021-00614-4 Professional affiliations\nDelgado-Ron, J. A., Adhikari, B., Van den Bosch, M., Dummer, T., Hong, A., Sandhu, J., … & Frank, L. D. (2021). Community design and hypertension: Walkability and park access relationships with cardiovascular health. International Journal of Hygiene and Environmental Health, 237, 113820. https://doi.org/10.1016/j.ijheh.2021.113820"
  },
  {
    "objectID": "index.html#personal-life",
    "href": "index.html#personal-life",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "Personal life",
    "text": "Personal life\nI live in Ottawa, ON, with my wife, Andrea, and my daughter, Alice. I was born in Quito, Ecuador, but spent my formative years in Vancouver, BC. I have been a permanent resident of Canada since 2029.\nIn my free time, I enjoy reading (mostly non-fiction graphic novels), biking, and playing chess (I have a 1600 chess.com rating). I write as a hobby and have won third place in a national contest of really short stories (my micro tales have been included in a couple of anthologies). I was first published in English in “Writing in the Time of COVID.”"
  },
  {
    "objectID": "index.html#r-code-stories",
    "href": "index.html#r-code-stories",
    "title": "Jorge Andrés Delgado-Ron",
    "section": "R Code Stories",
    "text": "R Code Stories\n\nCreating BC Schools Master File is a short data-wrangling story about matching schools with health authorities using publicly available datasets."
  },
  {
    "objectID": "Creating_BC_schools_Master_File.html",
    "href": "Creating_BC_schools_Master_File.html",
    "title": "Creating the BC Schools Master File",
    "section": "",
    "text": "This document uses two data sources:\n\nThe mailing information for all schools from the BC School District and Contact Information website (https://bcschoolcontacts.gov.bc.ca/). Click “Download Schools Info” followed up by “All schools”; and\nBC Stats’ Translation of Place Names into Administrative Areas. You can search this file with quotation marks at the BC Stats website (https://www2.gov.bc.ca/gov/search), but you will have better luck with the direct link (below)."
  },
  {
    "objectID": "Creating_BC_schools_Master_File.html#data-sources",
    "href": "Creating_BC_schools_Master_File.html#data-sources",
    "title": "Creating the BC Schools Master File",
    "section": "",
    "text": "This document uses two data sources:\n\nThe mailing information for all schools from the BC School District and Contact Information website (https://bcschoolcontacts.gov.bc.ca/). Click “Download Schools Info” followed up by “All schools”; and\nBC Stats’ Translation of Place Names into Administrative Areas. You can search this file with quotation marks at the BC Stats website (https://www2.gov.bc.ca/gov/search), but you will have better luck with the direct link (below)."
  },
  {
    "objectID": "Creating_BC_schools_Master_File.html#importing-data",
    "href": "Creating_BC_schools_Master_File.html#importing-data",
    "title": "Creating the BC Schools Master File",
    "section": "Importing Data",
    "text": "Importing Data\nLoading the files:\n\nmailing &lt;- read.csv(\"data/allschoolcontacts.csv\", na.strings = \"\") %&gt;%\n  janitor::clean_names() %&gt;% \n  select(district_number, \n         school_code, \n         school_name, \n         postal_code,\n         physical_postal_code,\n         school_category, \n         type,\n         city) %&gt;% \n  rename(school_district = district_number)\n# You may select other variables in the future \n# (e.g., enrollment for some grades)\n\nadmin_areas &lt;- openxlsx::read.xlsx(\"https://www2.gov.bc.ca/assets/gov/data/geographic/land-use/administrative-boundaries/translation_place_names2019.xlsx\", startRow = 4)%&gt;% \n  janitor::clean_names() %&gt;% \n  slice(.,-1) %&gt;% #The first row is empty data\n  rename(health_authority_name = x11)"
  },
  {
    "objectID": "Creating_BC_schools_Master_File.html#data-wrangling",
    "href": "Creating_BC_schools_Master_File.html#data-wrangling",
    "title": "Creating the BC Schools Master File",
    "section": "Data wrangling",
    "text": "Data wrangling\nLet’s take a look at the mailing dataset:\n\nglimpse(mailing)\n\nRows: 2,304\nColumns: 8\n$ school_district      &lt;int&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5…\n$ school_code          &lt;int&gt; 501007, 501009, 501010, 501017, 502001, 502011, 5…\n$ school_name          &lt;chr&gt; \"Jaffray Elem-Jr Secondary\", \"Isabella Dicken Ele…\n$ postal_code          &lt;chr&gt; \"V0B1T0\", \"V0B1M0\", \"V0B2G0\", \"V0B1H0\", \"V1C1B2\",…\n$ physical_postal_code &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ school_category      &lt;chr&gt; \"Public School\", \"Public School\", \"Public School\"…\n$ type                 &lt;chr&gt; \"Standard school\", \"Standard school\", \"Standard s…\n$ city                 &lt;chr&gt; \"JAFFRAY\", \"FERNIE\", \"SPARWOOD\", \"ELKFORD\", \"CRAN…\n\n\nIt looks like the schools have two postal codes. We need the physical postal code because we are interested in the distance from the school to the student’s house. But most schools only provided this information under “postal code”. So we need to do some cleaning here:\n\n# If the physical_postal_code variable is not empty, \n# I want it to replace the postal_code variable\n\nmailing$postal_code &lt;- ifelse(!is.na(mailing$physical_postal_code), #condition\n                              mailing$physical_postal_code, #true \n                              mailing$postal_code) #false\n\n# Now we can delete redundant information\nmailing$physical_postal_code &lt;- NULL\n\nWe also need the short version of the postal code for later.\n\n# substr (target, first_character, last_character)\nmailing$short_postal_code &lt;- substr(mailing$postal_code,1,3)\n\nNow that everything is sorted, we can just add the health authorities from the admin_areas file.\n\n# I am telling R to match the two dataframes by school_district,\n# then to find the health_authority_name  variable in the admin_areas dataframe.\nmailing$health_authority &lt;-\n  admin_areas$health_authority_name[match(mailing$school_district,\n                                          admin_areas$school_district)]\n\n# That is all I needed from this dataframe\nadmin_areas &lt;- NULL\n\nDid everyone get a health authority?\n\nround(100*prop.table(table(!is.na(mailing$health_authority))),1)\n\n\nFALSE  TRUE \n  2.4  97.6 \n\n\nIt looks like a few entries did not. Let’s find out which districts are missing.\n\nunique(mailing$school_district[is.na(mailing$health_authority)])\n\n[1] 93\n\n\nOk, I just googled it!\n\nThe Conseil scolaire francophone de la Colombie-Britannique is the French-language school board for all French schools located in British Columbia.\n\nThis is an interesting problem because district 93 is the only one that can be located in many health authorities. So, we are going to find the health authority for each school using their 3-character postal code. But first, I want to make sure all missing postal codes can be matched with existing postal codes.\n\nlost_postal_codes &lt;- mailing$short_postal_code[is.na(mailing$health_authority)]\nknown_postal_codes &lt;- mailing$short_postal_code[!is.na(mailing$health_authority)]\n\ntable(lost_postal_codes %in% known_postal_codes) #Verifying no one is left behind\n\n\nTRUE \n  55 \n\n\nSuccess! Now let’s get to work. First I want to create a dataframe with short postal codes and health authorities\n\nHA_finder &lt;- mailing  %&gt;% \n  filter(!is.na(health_authority)) %&gt;% \n  group_by(short_postal_code) %&gt;% \n  reframe(HA = health_authority) %&gt;%\n  unique.array() \n\nglimpse(HA_finder)\n\nRows: 207\nColumns: 2\n$ short_postal_code &lt;chr&gt; \"V0A\", \"V0B\", \"V0C\", \"V0E\", \"V0E\", \"V0G\", \"V0H\", \"V0…\n$ HA                &lt;chr&gt; \"Interior\", \"Interior\", \"Northern\", \"Interior\", \"Nor…\n\n\nNext, I want to separate the French schools from the rest. Technically speaking, this is not really required. But it is easier to understand the code this way.\n\nmailing_complete &lt;- mailing %&gt;% filter(!is.na(health_authority))\nmailing_missing  &lt;- mailing %&gt;% filter(is.na(health_authority))\n\nNow we can match the health authority by postal code, just like we did before with school districts.\n\nmailing_missing$health_authority &lt;-\n  HA_finder$HA[match(mailing_missing$short_postal_code,\n                     HA_finder$short_postal_code)]\n\nFinally, we put together the pieces of the broken data frame and save it as a csv file to import it into the caraspace.\n\nmaster_file &lt;- rbind(mailing_complete,mailing_missing)\nwrite.csv(x = master_file, file = \"data/BC_schools_master_file.csv\")"
  },
  {
    "objectID": "Creating_BC_schools_Master_File.html#downloads",
    "href": "Creating_BC_schools_Master_File.html#downloads",
    "title": "Creating the BC Schools Master File",
    "section": "Downloads",
    "text": "Downloads\nDownload the file here."
  }
]